# mkxp-z-libretro-emscripten

This is a website where you can test the proposed libretro builds for [mkxp-z](https://github.com/mkxp-z/mkxp-z) from [mkxp-z pull request 255](https://github.com/mkxp-z/mkxp-z/pull/255) in your browser.

Unlike [mkxp-web](https://github.com/pulsejet/mkxp-web), it uses the reference Ruby VM implementation instead of mruby, so RPG Maker VX and RPG Maker VX Ace games are supported out of the box, not only RPG Maker XP games. There are no special porting steps [like the ones required to play games using mkxp-web](https://github.com/pulsejet/mkxp-web?tab=readme-ov-file#porting-games-to-work-with-mrubywasm); games should be runnable unmodified if mkxp-z can play the game on at least one non-Windows platform.

There are multiple different user interfaces available:

* [RetroArch web player](https://white-axe.github.io/mkxp-z-libretro-emscripten/retroarch-web-player/). The reference implementation of a user interface for running libretro cores in web browsers. It allows uploading games of your choice to play. See below for instructions on how to upload games.
* [Nostalgist.js with Aetherion](https://white-axe.github.io/mkxp-z-libretro-emscripten/nostalgist-aetherion/). A user interface using Nostalgist.js preconfigured to play the RPG Maker VX game [Aetherion](https://rpgmaker.net/games/3410/) by Anaryu, Krisanna and Solitayre. This build serves to demonstrate the running of a game that requires Win32API.
* [Nostalgist.js with Crysalis](https://white-axe.github.io/mkxp-z-libretro-emscripten/nostalgist-crysalis/). A user interface using Nostalgist.js preconfigured to play the RPG Maker VX Ace sample game Crysalis. This build serves to demonstrate the running of a game that requires Ruby fibers, which is not possible with mruby due to the [limitations of mruby](https://github.com/mruby/mruby/blob/3.4.0/doc/limitations.md#fiber-execution-cant-cross-c-function-boundary).
* [Nostalgist.js with KNight-Blade: Howling of Kerberos](https://white-axe.github.io/mkxp-z-libretro-emscripten/nostalgist-knight-blade-howling-of-kerberos/). A user interface using Nostalgist.js preconfigured to play the English version of the RPG Maker XP sample game KNight-Blade: Howling of Kerberos, as a sanity check.
* [Nostalgist.js with Star Stealing Prince](https://white-axe.github.io/mkxp-z-libretro-emscripten/nostalgist-star-stealing-prince/). A user interface using Nostalgist.js preconfigured to play the RPG Maker VX game [Star Stealing Prince](https://starstealingprince.wordpress.com/) by Ronove and Diedrupo. This build serves to demonstrate the running of a game that requires Ruby 1.8 syntax and will not normally run in newer Ruby versions.

## How to use the RetroArch web player

To play a game with the RetroArch web player, put all the game files inside a .zip or .7z archive and change the file extension of that archive to ".mkxpz". Try to make sure the files inside the archive are not compressed (i.e. they should use the "store" compression algorithm), especially .rgssad/.rgss2a/.rgss3a files and .otf/.ttf files; failing to do this will most likely result in severe in-game lag due to the amount of seeking required to use these files, but the game should still be playable, so it's okay if you can't figure out how to do this. Currently, if the game requires RTPs, you have to copy the RTP files over the game files because the web player doesn't have a convenient way to upload RTP files yet and loading RTPs from paths inside of the game archive is not supported.

After you have the game packed into an archive, go to [the page for the RetroArch web player](https://white-axe.github.io/mkxp-z-libretro-emscripten/retroarch-web-player/), wait until it finishes loading, then use the "Add Content" button in the top bar to upload the game archive. In RetroArch, select "Load Content" and then "Start Directory", then select the game archive you uploaded (it might take a few seconds to load). Any errors will appear in the developer console in your browser, so check that if there are any issues loading or playing the game.

There's currently no convenient way to upload saves or save states to the RetroArch web player, although this will probably be fixed at some point. You can, however, download saves, save states and screenshots that were made inside of the web player by clicking on the button to the right of the "Add Content" button in the top bar and clicking on "Download saves/states/screenshots". Save states are cross-platform, so any downloaded save states should work in libretro builds of mkxp-z on other platforms as well.
